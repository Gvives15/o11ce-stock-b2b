{"tasks": [{"task_id": "B2-FE-T1", "dependent_task_ids": [], "instruction": "Crear PaymentsStore (estado y validaciones) - Crear `src/stores/payments.ts` (Pinia) con: `payments:[{method:'cash'|'card'|'transfer'|'cc', amount:number}]`, acciones `addPayment(method,amount)`, `remove(i)`, `setAmount(i, n)`, getter `totalPaid`, y funci\u00f3n `validateAgainst(total)` que devuelve `{ok:boolean, change:number, error?:string}` (ok si `totalPaid >= total`). DoD: c\u00e1lculos exactos; `change = totalPaid - total`.", "task_type": "general", "code": "", "result": "", "is_success": false, "is_finished": false, "assignee": "Alex", "start_at": 1758513730.1254704}, {"task_id": "B2-FE-T2", "dependent_task_ids": ["B2-FE-T1"], "instruction": "Crear PaymentsPanel (UI + UX) - Crear `src/components/PaymentsPanel.vue` con select de m\u00e9todo y campo monto; bot\u00f3n 'Agregar'. Lista de pagos con borrar/editar; muestra `totalPagado` y `vuelto`. Reglas: montos \u2265 0; si m\u00e9todo `cc` solo si el cliente lo permite (prop `allowCC`). Emite evento `validityChanged({ok, change})`. DoD: split payment funcionando, vuelto correcto.", "task_type": "general", "code": "", "result": "", "is_success": false, "is_finished": false, "assignee": "Alex"}, {"task_id": "B2-FE-T3", "dependent_task_ids": [], "instruction": "Crear useCheckout (cliente de API con idempotencia) - Crear `src/composables/useCheckout.ts` con funci\u00f3n `checkout({customerId, items, payments, idempotencyKey})`. Usa `axiosClient.post('/pos/checkout', body, { headers:{'Idempotency-Key': key}})`. Maneja 201 y 409; retorna `{ok, data?, missing?, error?}`. DoD: agrega header y mapea 201/409.", "task_type": "general", "code": "", "result": "", "is_success": false, "is_finished": false, "assignee": "Alex"}, {"task_id": "B2-FE-T4", "dependent_task_ids": [], "instruction": "IdempotencyKey (generaci\u00f3n y ciclo) - En `src/stores/sale.ts`, agregar `idempotencyKey:string` (uuid v4). Acci\u00f3n `resetKey()` al iniciar una venta y despu\u00e9s de un checkout exitoso. PosView usa esta key en `useCheckout`. DoD: cada venta sale con key \u00fanica.", "task_type": "general", "code": "", "result": "", "is_success": false, "is_finished": false, "assignee": "Alex"}, {"task_id": "B2-FE-T5", "dependent_task_ids": ["B2-FE-T1", "B2-FE-T2", "B2-FE-T3", "B2-FE-T4"], "instruction": "Integraci\u00f3n Checkout en PosView - Actualizar `src/views/PosView.vue`: Obtener `total` desde `TotalsPanel` y `payments` desde `PaymentsStore`. Bot\u00f3n **Cobrar** habilitado si: no offline, turno/caja abiertos (useBlockers), `payments.validateAgainst(total).ok`, carrito no vac\u00edo. Al click: llamar `useCheckout` con `{customerId, items: cart.asQuoteItems(), payments, idempotencyKey}`. DoD: cobra cuando todo es v\u00e1lido.", "task_type": "general", "code": "", "result": "", "is_success": false, "is_finished": false, "assignee": "Alex"}], "current_task_id": "B2-FE-T1"}
