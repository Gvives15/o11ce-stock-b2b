{"tasks": [{"task_id": "1", "dependent_task_ids": [], "instruction": "Implement B0-FE-01 - Vue.js routes with role-based guards. Create a complete Vue.js application with the following requirements:\n\n**Technical Stack:** Vue 3, TypeScript, Vue Router, Pinia, Tailwind CSS\n\n**Tasks to implement:**\n\n1. **Initialize base routes** - Create `src/router/index.ts` with routes: `/pos`, `/history`, `/settings`, `/login`, `/denied`. Use HTML5 history mode. Set redirects: `/` \u2192 `/pos` and `/*` \u2192 `/pos`.\n\n2. **Create auth store (Pinia)** - Create `src/stores/auth.ts` with state: `tokenAccess: string|null`, `roles: string[]`, `profileLoaded: boolean`. Actions: `setToken(token)`, `loadProfile()` (GET `/auth/me`), `logout()`.\n\n3. **Create minimal views** - Create placeholder views: `src/views/PosView.vue`, `HistoryView.vue`, `SettingsView.vue`, `LoginView.vue`, `DeniedView.vue` with simple templates showing titles.\n\n4. **Add route metadata** - In `router/index.ts`, add `meta.requiresAuth` and `meta.roles`:\n   - `/pos`, `/history`: `['vendedor_caja','admin']`\n   - `/settings`: `['admin']`\n   - `/login`, `/denied`: no auth required\n\n5. **Implement global guard (beforeEach)** - Add router guard:\n   - If `!requiresAuth` \u2192 allow\n   - If no `tokenAccess` \u2192 redirect to `/login?redirect=<to>`\n   - If `!profileLoaded` \u2192 `await auth.loadProfile()` (try/catch \u2192 logout and `/login`)\n   - Check `allowedRoles` vs `auth.roles` \u2192 if not allowed, go to `/denied`\n\n6. **Add loader/loading state** - Add NProgress or simple overlay: start in `beforeEach`, finish in `afterEach`. Block render until `profileLoaded`.\n\n7. **Post-login redirection** - In `LoginView.vue`, after `setToken(access)`: read `route.query.redirect || '/pos'` and `router.push` there.\n\n8. **Access denied page** - In `DeniedView.vue`, show 403 message + \"Back\" button (`router.back()` or `router.push('/pos')`).\n\n9. **POS layout** - Create `src/layouts/POSLayout.vue` with simple header and `<router-view/>`. Use it in protected routes.\n\n10. **Basic tests** - Add unit tests for guard logic and basic E2E test for login flow.\n\n11. **Update README** - Document routes, `meta.roles`, how guard works, how to simulate roles.\n\n**Acceptance Criteria:**\n- Without token, protected route \u2192 `/login` with `?redirect`\n- `vendedor_caja` accesses `/pos` and `/history`, NOT `/settings`\n- `admin` accesses all routes\n- Loading state visible while resolving `/auth/me`\n- Clear denied page with exit option\n- No flickering during route transitions\n\n**File Structure:**\n```\nsrc/\n  router/index.ts\n  stores/auth.ts\n  views/\n    PosView.vue\n    HistoryView.vue\n    SettingsView.vue\n    LoginView.vue\n    DeniedView.vue\n  layouts/\n    POSLayout.vue\n```\n\nUse Vue 3 Composition API, TypeScript, and ensure proper error handling for authentication flows.", "task_type": "general", "code": "", "result": "", "is_success": false, "is_finished": true, "assignee": "Alex", "start_at": 1758506236.151208, "end_at": 1758506551.3452387}], "current_task_id": ""}
